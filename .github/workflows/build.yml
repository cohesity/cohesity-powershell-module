name: Build
on: [push]
jobs:
  Check-Path:
    runs-on: windows-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Setup .NET 4.5.1
        uses: actions/setup-dotnet@v1
        with:
          # Semantic version range syntax or exact version of a dotnet version
          dotnet-version: '4.5.1'
      - name: Setup .NET Core SDK 2.2
        uses: actions/setup-dotnet@v1.7.2
        with:
          dotnet-version: '2.2'
      # You can test your matrix by printing the current dotnet version
      - name: Display dotnet version
        run: dotnet --version
      - name: Install dependencies
        run: dotnet add package Newtonsoft.Json --version 12.0.1
      - name: Clean the project
        run: dotnet clean --configuration Release
      - name: Build the project
        run: dotnet build --configuration Release
      - name: Testing a plain message
        shell: powershell
        run: write-host "Check for current path $pwd"
      - name: Run script analyser
        shell: powershell
        run: |
          Invoke-ScriptAnalyzer -Path "./src/Cohesity.Powershell/Scripts/*/*.ps1" -ExcludeRule PSAvoidGlobalVars, PSUseSingularNouns  | Should -Be $null
